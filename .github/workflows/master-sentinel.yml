name: ğŸ§  Digital Sentinel PRIME v4.0 â€“ Deep Autonomous Hunter

on:
  schedule:
    - cron: "0 */6 * * *" # Ø¨Û•Ø±Ø¯Û•ÙˆØ§Ù… Ù‡Û•Ø± Ù¦ Ú©Ø§ØªÚ˜Ù…ÛØ± Ø¬Ø§Ø±ÛÚ©
  workflow_dispatch:

jobs:
  dispatch_scans:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        worker: [1, 2, 3, 4] # Ù¤ worker parallel cluster
    timeout-minutes: 240

    steps:
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v4

      - name: âš™ï¸ Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: ğŸ§© Install Dependencies
        run: |
          sudo apt-get update -qq
          sudo apt-get install -y jq nmap
          pip install requests aiohttp beautifulsoup4

      - name: ğŸš€ Dispatch Worker Sentinel
        run: |
          echo "ğŸ“¡ Dispatching Deep Scan to Worker #${{ matrix.worker }}"
          curl -X POST \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" \
            -H "X-GitHub-Api-Version: 2022-11-28" \
            https://api.github.com/repos/${{ github.repository }}/dispatches \
            -d "{
              \"event_type\": \"scan_target\",
              \"client_payload\": {
                \"worker_id\": \"${{ matrix.worker }}\",
                \"mode\": \"deep\",
                \"ai_analysis\": true
              }
            }"
          
      - name: ğŸ¤– Send AI Summary to Discord
        if: always()
        run: |
          curl -H "Content-Type: application/json" \
          -d "{
            \"content\": \"ğŸ§  Digital Sentinel PRIME v4.0 cycle complete (Worker #${{ matrix.worker }}) âœ…\"
          }" \
          "${{ secrets.DISCORD_WEBHOOK_URL }}"
