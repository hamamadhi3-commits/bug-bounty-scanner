name: âš¡ Worker Sentinel â€“ Deep Mode

on:
  repository_dispatch:
    types: [scan_target]

jobs:
  deep_scan:
    runs-on: ubuntu-latest
    timeout-minutes: 180

    steps:
      - name: ğŸ“¦ Checkout Repo
        uses: actions/checkout@v4

      - name: âš™ï¸ Setup Environment
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: ğŸ”§ Install Dependencies
        run: |
          pip install aiohttp requests beautifulsoup4

      - name: ğŸ” Run Deep Scan
        run: |
          python3 src/scan_engine.py --mode deep --worker ${{ github.event.client_payload.worker_id }}

      - name: ğŸ“Š Generate Report
        run: |
          python3 src/auto_report.py

      - name: ğŸ“£ Notify Discord
        run: |
          python3 src/discord_notify.py
